# **Семинар 2. Реализация фильтров и морфологических операций**

---

## **Задания**

---

### **1. Реализация 2D-свёртки вручную**

**Цель:** понять механику свёртки и влияние ядра на результат.

**Инструкции:**

1. Реализуйте функцию двумерной свёртки на NumPy без использования `cv2.filter2D`.
2. Используйте паддинг типа `reflect` или `constant`.
3. Примените вашу свёртку к изображению с ядрами:

   * усредняющим (3\times 3);
   * гауссовым (заданным вручную).
4. Сравните результаты с `cv2.filter2D`: визуально и по MSE.

---

### **2. Применение различных сглаживающих фильтров**

**Цель:** сравнить эффекты разных линейных и нелинейных фильтров.

**Инструкции:**

1. Добавьте к изображению гауссов шум и шум «соль и перец».
2. Примените фильтры:

   * усредняющий (`cv2.blur`),
   * гауссов (`cv2.GaussianBlur`),
   * медианный (`cv2.medianBlur`),
   * билинейный (`cv2.bilateralFilter`).
3. Сравните качество восстановления: MSE, PSNR и визуальное восприятие.
4. Сделайте вывод, какой фильтр лучше работает для каждого типа шума.

---

### **3. Реализация повышения резкости (unsharp masking)**

**Цель:** освоить метод локального усиления деталей.

**Инструкции:**

1. Размойте изображение гауссовым фильтром.
2. Вычислите высокочастотную составляющую как разность исходного и размытого.
3. Сформируйте изображение:
   $$
   I_{\text{sharp}} = I + \lambda (I - I_{\text{blur}})
   $$
   с несколькими значениями (\lambda).
4. Покажите влияние (\lambda) на качество резкости и уровень шума.

---

### **4. Морфологические операции для бинарных масок**

**Цель:** освоить очистку и структурирование масок.

**Инструкции:**

1. Преобразуйте изображение в бинарное (глобальный или адаптивный порог).
2. Постройте структурирующий элемент разных форм и размеров (`cv2.getStructuringElement`).
3. Примените:

   * эрозию,
   * дилатацию,
   * открытие,
   * закрытие.
4. Сравните результаты: очистка шума, заполнение разрывов, изменение формы объекта.

---

### **5. Построение морфологического градиента**

**Цель:** изучить альтернативный способ выделения границ.

**Инструкции:**

1. Постройте морфологический градиент:
   $$
   \text{grad}(I) = (I \oplus B) - (I \ominus B)
   $$
2. Используйте несколько структурирующих элементов: диск, квадрат, крест.
3. Сравните морфологический градиент с градиентом Собеля.
4. Определите, в каких случаях морфология выделяет границы лучше.

---

### **6. Частотная фильтрация (дополнительное задание)**

**Цель:** связать пространственную и частотную фильтрации.

**Инструкции:**

1. Выполните 2D-Фурье-преобразование изображения.
2. Постройте маску низких частот и маску высоких частот.
3. Примените обе маски и выполните обратное преобразование.
4. Сравните результаты с гауссовым сглаживанием и операторами Лапласа/Собеля.

---
